#!/bin/sh

if [ "$#" -ne 1 ]; 
then 
    WORKDIR=`pwd`
else 
    WORKDIR=$1
fi

if [ "$#" -ne 2 ]; 
then 
    SESSION_NAME=${PWD##*/}
else 
    SESSION_NAME=$2
fi

tmux new-session -d -s $SESSION_NAME
 
tmux new-window -t $SESSION_NAME:1 -n 'git'
tmux send-keys -t $SESSION_NAME:1 "cd $WORKDIR" C-m

tmux new-window -t $SESSION_NAME:2 -n 'runners'
tmux send-keys -t $SESSION_NAME:2 "cd $WORKDIR" C-m

tmux new-window -t $SESSION_NAME:3 -n 'console'
tmux send-keys -t $SESSION_NAME:3 "cd $WORKDIR" C-m

tmux new-window -t $SESSION_NAME:4 -n 'postgres'
tmux send-keys -t $SESSION_NAME:4 'psql -U postgres -h 127.0.0.1; clear' C-m

tmux new-window -t $SESSION_NAME:5 -n 'editor'
tmux send-keys -t $SESSION_NAME:5 "cd $WORKDIR; nnvim" C-m
 
tmux new-window -t $SESSION_NAME:6 -n 'search'
tmux send-keys -t $SESSION_NAME:6 "cd $WORKDIR" C-m
 
tmux new-window -t $SESSION_NAME:7 -n 'tests'
tmux send-keys -t $SESSION_NAME:7 "cd $WORKDIR" C-m
 
tmux new-window -t $SESSION_NAME:8 -n 'crons'
tmux send-keys -t $SESSION_NAME:8 "cd $WORKDIR" C-m

tmux select-window -t $SESSION_NAME:3
tmux -2 attach-session -t $SESSION_NAME
